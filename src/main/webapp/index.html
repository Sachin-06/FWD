<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Food Waste Donation Portal</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f5f7fa; }
    .container { width: 420px; margin: 40px auto; background: #fff;
                 padding: 28px; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,.12);}
    h2 { margin-bottom: 16px; }
    input, select, button { width: 100%; padding: 10px; margin: 10px 0; border-radius: 7px; border: 1px solid #bbb;}
    button { background: #1270e3; color: #fff; border: none;}
    button:hover { background: #235dbe;}
    .msg { margin-top:18px; font-weight: 500; color: #1d891d;}
    .error { color: #d40000; }
    .navbtn { margin-bottom: 3px; }
  </style>
  <script>
    // Form switching
    function showForm(id) {
      document.querySelectorAll('.form-container').forEach(div => div.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    function displayMsg(formId, msg, isError=false) {
      const msgEl = document.getElementById(formId + '-msg');
      msgEl.textContent = msg;
      msgEl.className = isError ? 'error msg' : 'msg';
    }

    // Generic AJAX POST
    function submitForm(event, servletUrl, formId) {
      event.preventDefault();
      var form = document.getElementById(formId);
      var formData = new FormData(form);
      fetch(servletUrl, { method: 'POST', body: formData })
        .then(r => r.json())
        .then(json => {
          displayMsg(formId, json.message, json.status !== 'success');
        })
        .catch(() => displayMsg(formId, 'Server error', true));
    }
  </script>
</head>
<body>
  <div class="container">
    <h2>Food Waste Donation System</h2>
    <div>
      <button class="navbtn" onclick="showForm('login-form')">Login</button>
      <button class="navbtn" onclick="showForm('register-form')">Register</button>
      <button class="navbtn" onclick="showForm('donor-form')">Donor Submission</button>
    </div>

    <!-- Login Form -->
    <div id="login-form" class="form-container" style="display:none;">
      <form id="login-form" onsubmit="submitForm(event, 'LoginServlet', 'login-form')">
        <h3>Login</h3>
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
      <span id="login-form-msg" class="msg"></span>
    </div>

    <!-- Register Form -->
    <div id="register-form" class="form-container" style="display:none;">
      <form id="register-form" onsubmit="submitForm(event, 'RegisterServlet', 'register-form')">
        <h3>Register</h3>
        <input type="text" name="name" placeholder="Name" required>
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Password" required>
        <select name="usertype" required>
            <option value="">Role</option>
            <option value="donor">Donor</option>
            <option value="delivery">Delivery Person</option>
            <option value="admin">Admin</option>
        </select>
        <input type="text" name="phone" placeholder="Phone" required>
        <input type="text" name="address" placeholder="Address" required>
        <button type="submit">Register</button>
      </form>
      <span id="register-form-msg" class="msg"></span>
    </div>

    <!-- Donor Submission Form -->
    <div id="donor-form" class="form-container" style="display:none;">
      <form id="donor-form" onsubmit="submitForm(event, 'DonorSubmissionServlet', 'donor-form')">
        <h3>Submit Excess Food (Donor)</h3>
        <input type="number" name="donorid" placeholder="Your User ID" required>
        <input type="text" name="foodtype" placeholder="Food Type" required>
        <input type="text" name="quantity" placeholder="Quantity (e.g. 10kg, 5 boxes)" required>
        <input type="text" name="pickupLocation" placeholder="Pickup Location" required>
        <button type="submit">Submit Donation</button>
      </form>
      <span id="donor-form-msg" class="msg"></span>
    </div>
  </div>
</body>
</html>
